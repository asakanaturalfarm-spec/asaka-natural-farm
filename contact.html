<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO ãƒ¡ã‚¿ã‚¿ã‚° -->
    <title>ãŠå•ã„åˆã‚ã› | è‡ªç„¶è¾²æ³•é‡èœã«ã¤ã„ã¦ã®ã”è³ªå• | å®‰ç©ç›´å£²æ‰€</title>
    <meta name="description" content="å®‰ç©ç›´å£²æ‰€ã¸ã®ãŠå•ã„åˆã‚ã›ã€‚è‡ªç„¶è¾²æ³•é‡èœã€å•†å“ã€é…é€ã€æ±ºæ¸ˆæ–¹æ³•ãªã©ã«é–¢ã™ã‚‹ã”è³ªå•ã‚„ã”ç›¸è«‡ã‚’ãŠå—ã‘ã—ã¾ã™ã€‚å¹³æ—¥9:00ï½17:00å¯¾å¿œã€‚ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚">
    <meta name="keywords" content="ãŠå•ã„åˆã‚ã›,ã‚³ãƒ³ã‚¿ã‚¯ãƒˆ,ç›¸è«‡,è‡ªç„¶è¾²æ³•,ç„¡è¾²è–¬é‡èœ,å®‰ç©ç›´å£²æ‰€,ç¦å³¶çœŒ,éƒ¡å±±å¸‚,å–å¼•,æ¥­å‹™,è²©å£²">
    <link rel="canonical" href="https://asakanatural.jp/shop/contact.html">
    <meta name="robots" content="index, follow">
    
    <!-- OGP -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://asakanatural.jp/shop/contact.html">
    <meta property="og:title" content="ãŠå•ã„åˆã‚ã› | å®‰ç©ç›´å£²æ‰€">
    <meta property="og:description" content="è‡ªç„¶è¾²æ³•é‡èœã«é–¢ã™ã‚‹ã”è³ªå•ã‚„ã”ç›¸è«‡ã‚’ãŠå—ã‘ã—ã¾ã™ã€‚ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚">
    <meta property="og:image" content="https://asakanatural.jp/shop/image/seika/sample1.jpg">
    <link rel="stylesheet" href="style.css?v=3">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@500;700&family=Noto+Sans+JP:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="auth.js"></script>
    <style>
        .contact-page {
            min-height: 100vh;
            background: var(--bg-cream);
            padding: 120px 40px 80px;
        }

        .contact-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .contact-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .contact-header h1 {
            font-size: 40px;
            color: var(--text-dark);
            font-family: 'Noto Serif JP', serif;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .contact-header p {
            color: var(--text-light);
            font-size: 16px;
        }

        .contact-form {
            background: white;
            border-radius: 16px;
            padding: 48px;
            box-shadow: var(--shadow-sm);
        }

        .form-section {
            margin-bottom: 32px;
        }

        .form-section h3 {
            font-size: 18px;
            color: var(--text-dark);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-dark);
            font-size: 15px;
            font-weight: 500;
        }

        .required {
            color: #dc3545;
            margin-left: 4px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 14px 16px;
            border: 1.5px solid var(--border-medium);
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(45, 80, 22, 0.1);
        }

        .form-textarea {
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
        }

        .form-note {
            font-size: 13px;
            color: var(--text-light);
            margin-top: 8px;
        }

        .contact-info {
            background: var(--bg-light-green);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 32px;
        }

        .contact-info h4 {
            font-size: 16px;
            color: var(--text-dark);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .contact-info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 14px;
            color: var(--text-medium);
        }

        .contact-info-icon {
            width: 20px;
            text-align: center;
        }

        .btn-submit {
            width: 100%;
            padding: 18px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-submit:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-submit:disabled {
            background: var(--border-medium);
            cursor: not-allowed;
            transform: none;
        }

        .inquiry-history {
            margin-top: 48px;
            padding-top: 48px;
            border-top: 2px solid var(--border-subtle);
        }

        .inquiry-history h2 {
            font-size: 24px;
            color: var(--text-dark);
            margin-bottom: 24px;
            font-weight: 600;
        }

        .inquiry-card {
            background: white;
            border: 1.5px solid var(--border-subtle);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
        }

        .inquiry-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .inquiry-category {
            display: inline-block;
            padding: 6px 12px;
            background: var(--bg-light-green);
            color: var(--primary-color);
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
        }

        .inquiry-date {
            font-size: 13px;
            color: var(--text-light);
        }

        .inquiry-subject {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .inquiry-message {
            font-size: 14px;
            color: var(--text-medium);
            line-height: 1.6;
        }

        .inquiry-status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 12px;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-responded {
            background: #d4edda;
            color: #155724;
        }

        .empty-history {
            text-align: center;
            padding: 48px;
            color: var(--text-light);
        }

        .empty-history-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        @media (max-width: 768px) {
            .contact-page {
                padding: 80px 8px 40px;
            }

            .contact-container {
                max-width: 100%;
                width: 100%;
                margin: 0 auto;
            }

            .contact-form {
                padding: 24px 8px;
                box-sizing: border-box;
                width: 100%;
                min-width: 0;
                overflow-x: hidden;
            }

            .form-section,
            .form-group,
            .form-input,
            .form-select,
            .form-textarea {
                max-width: 100%;
                width: 100%;
                box-sizing: border-box;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <header class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="logo">
                <div class="logo-text">
                    <h1>å®‰ç©ç›´å£²æ‰€</h1>
                    <p>è‡ªç„¶è¾²æ³•é‡èœ</p>
                </div>
            </a>
            
            <nav class="nav-menu">
                <a href="index.html" class="nav-link">ãƒ›ãƒ¼ãƒ </a>
                <a href="products.html" class="nav-link">å•†å“</a>
                <a href="contact.html" class="nav-link active">ãŠå•ã„åˆã‚ã›</a>
            </nav>

            <div class="nav-actions">
                <a href="account.html" class="btn-secondary">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
                <a href="cart.html" class="btn-primary">
                    <span class="cart-icon">ğŸ›’</span> ã‚«ãƒ¼ãƒˆ
                </a>
            </div>
        </div>
    </header>

    <div class="contact-page">
        <div class="contact-container">
            <div class="contact-header">
                <h1>ãŠå•ã„åˆã‚ã›</h1>
                <p>å•†å“ãƒ»é…é€ã«é–¢ã™ã‚‹ã”è³ªå•ã¯ã“ã¡ã‚‰ã‹ã‚‰ãŠå•ã„åˆã‚ã›ãã ã•ã„</p>
            </div>

            <div class="contact-form">
                <div class="contact-info">
                    <h4>ğŸ“ ç›´æ¥ãŠå•ã„åˆã‚ã›</h4>
                    <div class="contact-info-item">
                        <span class="contact-info-icon">ğŸ“§</span>
                        <span>ãƒ¡ãƒ¼ãƒ«ï¼šinfo@asaka-farm.jp</span>
                    </div>
                    <div class="contact-info-item">
                        <span class="contact-info-icon">ğŸ“±</span>
                        <span>é›»è©±ï¼š024-XXX-XXXXï¼ˆå¹³æ—¥ 9:00-17:00ï¼‰</span>
                    </div>
                    <div class="contact-info-item">
                        <span class="contact-info-icon">â°</span>
                        <span>å¯¾å¿œæ™‚é–“ï¼šå¹³æ—¥ãƒ»åœŸæ—¥ 9:00-17:00</span>
                    </div>
                </div>

                <form id="contactForm">
                    <div class="form-section">
                        <h3>ãŠå®¢æ§˜æƒ…å ±</h3>
                        
                        <div class="form-group">
                            <label class="form-label">
                                ãŠåå‰<span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="name" name="name" required readonly>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="required">*</span>
                            </label>
                            <input type="email" class="form-input" id="email" name="email" required readonly>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                é›»è©±ç•ªå·<span class="required">*</span>
                            </label>
                            <input type="tel" class="form-input" id="phone" name="phone" required>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>ãŠå•ã„åˆã‚ã›å†…å®¹</h3>
                        
                        <div class="form-group">
                            <label class="form-label">
                                ãŠå•ã„åˆã‚ã›ç¨®åˆ¥<span class="required">*</span>
                            </label>
                            <select class="form-select" id="category" name="category" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="product">å•†å“ã«ã¤ã„ã¦</option>
                                <option value="order">æ³¨æ–‡ã«ã¤ã„ã¦</option>
                                <option value="delivery">é…é€ã«ã¤ã„ã¦</option>
                                <option value="payment">æ”¯æ‰•ã„ã«ã¤ã„ã¦</option>
                                <option value="return">è¿”å“ãƒ»äº¤æ›ã«ã¤ã„ã¦</option>
                                <option value="other">ãã®ä»–</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ä»¶å<span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="subject" name="subject" required placeholder="ä¾‹ï¼šé…é€æ—¥æ™‚ã®å¤‰æ›´ã«ã¤ã„ã¦">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ãŠå•ã„åˆã‚ã›å†…å®¹<span class="required">*</span>
                            </label>
                            <textarea class="form-textarea" id="message" name="message" required placeholder="ã§ãã‚‹ã ã‘è©³ã—ãã”è¨˜å…¥ãã ã•ã„"></textarea>
                            <p class="form-note">â€»æ³¨æ–‡ç•ªå·ãŒã‚ã‚‹å ´åˆã¯å¿…ãšã”è¨˜å…¥ãã ã•ã„</p>
                        </div>
                    </div>

                    <button type="submit" class="btn-submit" id="submitBtn">é€ä¿¡ã™ã‚‹</button>
                </form>
            </div>

            <!-- å•ã„åˆã‚ã›å±¥æ­´ -->
            <div class="inquiry-history">
                <h2>å•ã„åˆã‚ã›å±¥æ­´</h2>
                <div id="inquiryHistory"></div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // å•ã„åˆã‚ã›ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæœ€å°é™ï¼‰
        // ========================================
        const INQUIRY_KEY = 'customer_inquiries';

        // ãƒ­ã‚°ã‚¤ãƒ³ãƒã‚§ãƒƒã‚¯ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è‡ªå‹•å…¥åŠ›
        window.addEventListener('DOMContentLoaded', () => {
            if (!window.Auth || !window.Auth.isLoggedIn()) {
                alert('ãŠå•ã„åˆã‚ã›ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚');
                window.location.href = 'login.html?redirect=contact.html';
                return;
            }

            const currentUser = window.Auth.getCurrentUser();
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è‡ªå‹•å…¥åŠ›
            document.getElementById('name').value = currentUser.name || '';
            document.getElementById('email').value = currentUser.email || '';
            document.getElementById('phone').value = currentUser.phone || '';

            // å•ã„åˆã‚ã›å±¥æ­´ã‚’è¡¨ç¤º
            loadInquiryHistory();
        });

        // å•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'é€ä¿¡ä¸­...';

            const currentUser = window.Auth.getCurrentUser();
            const formData = new FormData(this);

            const inquiry = {
                id: 'INQ_' + Date.now(),
                userId: currentUser.id,
                userName: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                category: formData.get('category'),
                subject: formData.get('subject'),
                message: formData.get('message'),
                status: 'pending',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            // LocalStorageã«ä¿å­˜
            const inquiries = JSON.parse(localStorage.getItem(INQUIRY_KEY) || '[]');
            inquiries.unshift(inquiry);
            localStorage.setItem(INQUIRY_KEY, JSON.stringify(inquiries));

            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã«POST
            // await fetch('/api/inquiries', { method: 'POST', body: JSON.stringify(inquiry) });

            console.log('[å•ã„åˆã‚ã›] é€ä¿¡å®Œäº†:', inquiry);

            alert('ãŠå•ã„åˆã‚ã›ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚\n2å–¶æ¥­æ—¥ä»¥å†…ã«ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚');

            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('subject').value = '';
            document.getElementById('message').value = '';
            document.getElementById('category').value = '';

            // å±¥æ­´ã‚’å†èª­ã¿è¾¼ã¿
            loadInquiryHistory();

            submitBtn.disabled = false;
            submitBtn.textContent = 'é€ä¿¡ã™ã‚‹';
        });

        // å•ã„åˆã‚ã›å±¥æ­´ã‚’èª­ã¿è¾¼ã¿
        function loadInquiryHistory() {
            const currentUser = window.Auth.getCurrentUser();
            const allInquiries = JSON.parse(localStorage.getItem(INQUIRY_KEY) || '[]');
            
            // è‡ªåˆ†ã®å•ã„åˆã‚ã›ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿
            const myInquiries = allInquiries.filter(inq => inq.userId === currentUser.id);

            const historyDiv = document.getElementById('inquiryHistory');

            if (myInquiries.length === 0) {
                historyDiv.innerHTML = `
                    <div class="empty-history">
                        <div class="empty-history-icon">ğŸ“­</div>
                        <p>å•ã„åˆã‚ã›å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</p>
                    </div>
                `;
                return;
            }

            historyDiv.innerHTML = myInquiries.map(inquiry => {
                const date = new Date(inquiry.createdAt);
                const categoryLabels = {
                    'product': 'å•†å“ã«ã¤ã„ã¦',
                    'order': 'æ³¨æ–‡ã«ã¤ã„ã¦',
                    'delivery': 'é…é€ã«ã¤ã„ã¦',
                    'payment': 'æ”¯æ‰•ã„ã«ã¤ã„ã¦',
                    'return': 'è¿”å“ãƒ»äº¤æ›',
                    'other': 'ãã®ä»–'
                };

                return `
                    <div class="inquiry-card">
                        <div class="inquiry-header">
                            <span class="inquiry-category">${categoryLabels[inquiry.category] || inquiry.category}</span>
                            <span class="inquiry-date">${date.toLocaleDateString('ja-JP')}</span>
                        </div>
                        <div class="inquiry-subject">${inquiry.subject}</div>
                        <div class="inquiry-message">${inquiry.message}</div>
                        <span class="inquiry-status ${inquiry.status === 'responded' ? 'status-responded' : 'status-pending'}">
                            ${inquiry.status === 'responded' ? 'âœ“ å›ç­”æ¸ˆã¿' : 'â³ å¯¾å¿œä¸­'}
                        </span>
                    </div>
                `;
            }).join('');
        }

        // ç®¡ç†è€…ç”¨ï¼šå•ã„åˆã‚ã›ä¸€è¦§å–å¾—ï¼ˆé–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
        window.getAllInquiries = function() {
            return JSON.parse(localStorage.getItem(INQUIRY_KEY) || '[]');
        };

        // ç®¡ç†è€…ç”¨ï¼šå•ã„åˆã‚ã›ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
        window.updateInquiryStatus = function(inquiryId, status) {
            const inquiries = JSON.parse(localStorage.getItem(INQUIRY_KEY) || '[]');
            const inquiry = inquiries.find(inq => inq.id === inquiryId);
            
            if (inquiry) {
                inquiry.status = status;
                inquiry.updatedAt = new Date().toISOString();
                localStorage.setItem(INQUIRY_KEY, JSON.stringify(inquiries));
                console.log('[å•ã„åˆã‚ã›] ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°:', inquiryId, status);
                return true;
            }
            
            return false;
        };
    </script>
</body>
</html>
